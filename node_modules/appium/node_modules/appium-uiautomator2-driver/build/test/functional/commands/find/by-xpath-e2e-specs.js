'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

var _ = require('../../../..');

var _2 = _interopRequireDefault(_);

var _sampleApps = require('sample-apps');

var _sampleApps2 = _interopRequireDefault(_sampleApps);

_chai2['default'].should();
_chai2['default'].use(_chaiAsPromised2['default']);

var driver = undefined;
var defaultCaps = {
  app: (0, _sampleApps2['default'])('ApiDemos-debug'),
  deviceName: 'Android',
  platformName: 'Android'
};
var atv = 'android.widget.TextView';
var f = "android.widget.FrameLayout";

describe('Find - xpath', function () {
  var _this = this;

  before(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          driver = new _2['default']();
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(driver.createSession(defaultCaps));

        case 3:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  after(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.deleteSession());

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should find element by type', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//' + atv, false));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.getText(el.ELEMENT).should.eventually.equal('API Demos'));

        case 5:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should find element by text', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//' + atv + '[@text=\'Accessibility\']', false));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.getText(el.ELEMENT).should.eventually.equal('Accessibility'));

        case 5:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should find element by attribute', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//*[@enabled=\'true\' and @scrollable=\'true\']', true).should.eventually.have.length(1));

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should find exactly one element via elementsByXPath', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//' + atv + '[@text=\'Accessibility\']', true));

        case 2:
          el = context$2$0.sent;

          el.length.should.equal(1);
          context$2$0.next = 6;
          return _regeneratorRuntime.awrap(driver.getText(el[0].ELEMENT).should.eventually.equal('Accessibility'));

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should find element by partial text', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//' + atv + '[contains(@text, \'Accessibility\')]', false));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.getText(el.ELEMENT).should.eventually.equal('Accessibility'));

        case 5:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should find the last element', function callee$1$0() {
    var el, text;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '(//' + atv + ')[last()]', false));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.getText(el.ELEMENT));

        case 5:
          text = context$2$0.sent;

          ["OS", "Text", "Views", "Preference"].should.include(text);

        case 7:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should find element by index and embedded desc', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//' + f + '//' + atv + '[5]', false));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.getText(el.ELEMENT).should.eventually.equal('Content'));

        case 5:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should find all elements', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//*', true));

        case 2:
          el = context$2$0.sent;

          el.length.should.be.above(2);

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should find the first element when searching for all elements', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//*', true));

        case 2:
          el = context$2$0.sent;

          el[0].should.exist;

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should find less elements with compression turned on', function callee$1$0() {
    var elementsWithoutCompression, elementsWithCompression;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.updateSettings({ "ignoreUnimportantViews": false }));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//*', true));

        case 4:
          elementsWithoutCompression = context$2$0.sent;
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.updateSettings({ "ignoreUnimportantViews": true }));

        case 7:
          context$2$0.next = 9;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//*', true));

        case 9:
          elementsWithCompression = context$2$0.sent;

          elementsWithoutCompression.length.should.be.greaterThan(elementsWithCompression.length);

        case 11:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should find toast message element by text', function callee$1$0() {
    var popUp, popUpEl, search, add, edit, share;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.startActivity('io.appium.android.apis', '.view.PopupMenu1'));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(driver.implicitWait(2000));

        case 4:
          context$2$0.next = 6;
          return _regeneratorRuntime.awrap(driver.findElOrEls('accessibility id', 'Make a Popup!', false));

        case 6:
          popUp = context$2$0.sent;
          popUpEl = popUp.ELEMENT;
          context$2$0.next = 10;
          return _regeneratorRuntime.awrap(driver.click(popUpEl));

        case 10:
          context$2$0.next = 12;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', './/*[@text=\'Search\']', false));

        case 12:
          search = context$2$0.sent;
          context$2$0.next = 15;
          return _regeneratorRuntime.awrap(driver.click(search.ELEMENT));

        case 15:
          context$2$0.next = 17;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//*[@text=\'Clicked popup menu item Search\']', false).should.eventually.exist);

        case 17:
          context$2$0.next = 19;
          return _regeneratorRuntime.awrap(driver.click(popUpEl));

        case 19:
          context$2$0.next = 21;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', './/*[@text=\'Add\']', false));

        case 21:
          add = context$2$0.sent;
          context$2$0.next = 24;
          return _regeneratorRuntime.awrap(driver.click(add.ELEMENT));

        case 24:
          context$2$0.next = 26;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//*[@text=\'Clicked popup menu item Add\']', false).should.eventually.exist);

        case 26:
          context$2$0.next = 28;
          return _regeneratorRuntime.awrap(driver.click(popUpEl));

        case 28:
          context$2$0.next = 30;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', './/*[@text=\'Edit\']', false));

        case 30:
          edit = context$2$0.sent;
          context$2$0.next = 33;
          return _regeneratorRuntime.awrap(driver.click(edit.ELEMENT));

        case 33:
          context$2$0.next = 35;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//*[@text=\'Clicked popup menu item Edit\']', false).should.eventually.exist);

        case 35:
          context$2$0.next = 37;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', './/*[@text=\'Share\']', false));

        case 37:
          share = context$2$0.sent;
          context$2$0.next = 40;
          return _regeneratorRuntime.awrap(driver.click(share.ELEMENT));

        case 40:
          context$2$0.next = 42;
          return _regeneratorRuntime.awrap(driver.findElOrEls('xpath', '//*[@text=\'Clicked popup menu item Share\']', false).should.eventually.exist);

        case 42:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3RcXGZ1bmN0aW9uYWxcXGNvbW1hbmRzXFxmaW5kXFxieS14cGF0aC1lMmUtc3BlY3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O29CQUFpQixNQUFNOzs7OzhCQUNJLGtCQUFrQjs7OztnQkFDUCxhQUFhOzs7OzBCQUM1QixhQUFhOzs7O0FBRXBDLGtCQUFLLE1BQU0sRUFBRSxDQUFDO0FBQ2Qsa0JBQUssR0FBRyw2QkFBZ0IsQ0FBQzs7QUFFekIsSUFBSSxNQUFNLFlBQUEsQ0FBQztBQUNYLElBQUksV0FBVyxHQUFHO0FBQ2hCLEtBQUcsRUFBRSw2QkFBVyxnQkFBZ0IsQ0FBQztBQUNqQyxZQUFVLEVBQUUsU0FBUztBQUNyQixjQUFZLEVBQUUsU0FBUztDQUN4QixDQUFDO0FBQ0YsSUFBSSxHQUFHLEdBQUcseUJBQXlCLENBQUM7QUFDcEMsSUFBSSxDQUFDLEdBQUcsNEJBQTRCLENBQUM7O0FBRXJDLFFBQVEsQ0FBQyxjQUFjLEVBQUUsWUFBWTs7O0FBQ25DLFFBQU0sQ0FBQzs7OztBQUNMLGdCQUFNLEdBQUcsbUJBQStCLENBQUM7OzJDQUNuQyxNQUFNLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQzs7Ozs7OztHQUN4QyxDQUFDLENBQUM7QUFDSCxPQUFLLENBQUM7Ozs7OzJDQUNFLE1BQU0sQ0FBQyxhQUFhLEVBQUU7Ozs7Ozs7R0FDN0IsQ0FBQyxDQUFDO0FBQ0gsSUFBRSxDQUFDLDZCQUE2QixFQUFFO1FBQzVCLEVBQUU7Ozs7OzJDQUFTLE1BQU0sQ0FBQyxXQUFXLENBQUMsT0FBTyxTQUFPLEdBQUcsRUFBSSxLQUFLLENBQUM7OztBQUF6RCxZQUFFOzsyQ0FDQSxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUM7Ozs7Ozs7R0FDdEUsQ0FBQyxDQUFDO0FBQ0gsSUFBRSxDQUFDLDZCQUE2QixFQUFFO1FBQzVCLEVBQUU7Ozs7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LENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQzs7OzsyQ0FDWixNQUFNLENBQUMsV0FBVyxDQUFDLE9BQU8seUJBQXVCLEtBQUssQ0FBQzs7O0FBQWxFLGFBQUc7OzJDQUNELE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQzs7OzsyQ0FDekIsTUFBTSxDQUFDLFdBQVcsQ0FBQyxPQUFPLGdEQUE4QyxLQUFLLENBQUMsQ0FDL0UsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLOzs7OzJDQUV0QixNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQzs7OzsyQ0FDVixNQUFNLENBQUMsV0FBVyxDQUFDLE9BQU8sMEJBQXdCLEtBQUssQ0FBQzs7O0FBQXJFLGNBQUk7OzJDQUNGLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQzs7OzsyQ0FDMUIsTUFBTSxDQUFDLFdBQVcsQ0FBQyxPQUFPLGlEQUErQyxLQUFLLENBQUMsQ0FDaEYsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLOzs7OzJDQUVWLE1BQU0sQ0FBQyxXQUFXLENBQUMsT0FBTywyQkFBeUIsS0FBSyxDQUFDOzs7QUFBdkUsZUFBSzs7MkNBQ0gsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDOzs7OzJDQUMzQixNQUFNLENBQUMsV0FBVyxDQUFDLE9BQU8sa0RBQWdELEtBQUssQ0FBQyxDQUNqRixNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUs7Ozs7Ozs7R0FDN0IsQ0FBQyxDQUFDO0NBQ0osQ0FBQyxDQUFDIiwiZmlsZSI6InRlc3RcXGZ1bmN0aW9uYWxcXGNvbW1hbmRzXFxmaW5kXFxieS14cGF0aC1lMmUtc3BlY3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY2hhaSBmcm9tICdjaGFpJztcclxuaW1wb3J0IGNoYWlBc1Byb21pc2VkIGZyb20gJ2NoYWktYXMtcHJvbWlzZWQnO1xyXG5pbXBvcnQgQW5kcm9pZFVpYXV0b21hdG9yMkRyaXZlciBmcm9tICcuLi8uLi8uLi8uLic7XHJcbmltcG9ydCBzYW1wbGVBcHBzIGZyb20gJ3NhbXBsZS1hcHBzJztcclxuXHJcbmNoYWkuc2hvdWxkKCk7XHJcbmNoYWkudXNlKGNoYWlBc1Byb21pc2VkKTtcclxuXHJcbmxldCBkcml2ZXI7XHJcbmxldCBkZWZhdWx0Q2FwcyA9IHtcclxuICBhcHA6IHNhbXBsZUFwcHMoJ0FwaURlbW9zLWRlYnVnJyksXHJcbiAgZGV2aWNlTmFtZTogJ0FuZHJvaWQnLFxyXG4gIHBsYXRmb3JtTmFtZTogJ0FuZHJvaWQnXHJcbn07XHJcbmxldCBhdHYgPSAnYW5kcm9pZC53aWRnZXQuVGV4dFZpZXcnO1xyXG5sZXQgZiA9IFwiYW5kcm9pZC53aWRnZXQuRnJhbWVMYXlvdXRcIjtcclxuXHJcbmRlc2NyaWJlKCdGaW5kIC0geHBhdGgnLCBmdW5jdGlvbiAoKSB7XHJcbiAgYmVmb3JlKGFzeW5jICgpID0+IHtcclxuICAgIGRyaXZlciA9IG5ldyBBbmRyb2lkVWlhdXRvbWF0b3IyRHJpdmVyKCk7XHJcbiAgICBhd2FpdCBkcml2ZXIuY3JlYXRlU2Vzc2lvbihkZWZhdWx0Q2Fwcyk7XHJcbiAgfSk7XHJcbiAgYWZ0ZXIoYXN5bmMgKCkgPT4ge1xyXG4gICAgYXdhaXQgZHJpdmVyLmRlbGV0ZVNlc3Npb24oKTtcclxuICB9KTtcclxuICBpdCgnc2hvdWxkIGZpbmQgZWxlbWVudCBieSB0eXBlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbE9yRWxzKCd4cGF0aCcsIGAvLyR7YXR2fWAsIGZhbHNlKTtcclxuICAgIGF3YWl0IGRyaXZlci5nZXRUZXh0KGVsLkVMRU1FTlQpLnNob3VsZC5ldmVudHVhbGx5LmVxdWFsKCdBUEkgRGVtb3MnKTtcclxuICB9KTtcclxuICBpdCgnc2hvdWxkIGZpbmQgZWxlbWVudCBieSB0ZXh0JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbE9yRWxzKCd4cGF0aCcsIGAvLyR7YXR2fVtAdGV4dD0nQWNjZXNzaWJpbGl0eSddYCwgZmFsc2UpO1xyXG4gICAgYXdhaXQgZHJpdmVyLmdldFRleHQoZWwuRUxFTUVOVCkuc2hvdWxkLmV2ZW50dWFsbHkuZXF1YWwoJ0FjY2Vzc2liaWxpdHknKTtcclxuICB9KTtcclxuICBpdCgnc2hvdWxkIGZpbmQgZWxlbWVudCBieSBhdHRyaWJ1dGUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBhd2FpdCBkcml2ZXIuZmluZEVsT3JFbHMoJ3hwYXRoJywgYC8vKltAZW5hYmxlZD0ndHJ1ZScgYW5kIEBzY3JvbGxhYmxlPSd0cnVlJ11gLCB0cnVlKVxyXG4gICAgICAgIC5zaG91bGQuZXZlbnR1YWxseS5oYXZlLmxlbmd0aCgxKTtcclxuICB9KTtcclxuICBpdCgnc2hvdWxkIGZpbmQgZXhhY3RseSBvbmUgZWxlbWVudCB2aWEgZWxlbWVudHNCeVhQYXRoJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbE9yRWxzKCd4cGF0aCcsIGAvLyR7YXR2fVtAdGV4dD0nQWNjZXNzaWJpbGl0eSddYCwgdHJ1ZSk7XHJcbiAgICBlbC5sZW5ndGguc2hvdWxkLmVxdWFsKDEpO1xyXG4gICAgYXdhaXQgZHJpdmVyLmdldFRleHQoZWxbMF0uRUxFTUVOVCkuc2hvdWxkLmV2ZW50dWFsbHkuZXF1YWwoJ0FjY2Vzc2liaWxpdHknKTtcclxuICB9KTtcclxuICBpdCgnc2hvdWxkIGZpbmQgZWxlbWVudCBieSBwYXJ0aWFsIHRleHQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsT3JFbHMoJ3hwYXRoJywgYC8vJHthdHZ9W2NvbnRhaW5zKEB0ZXh0LCAnQWNjZXNzaWJpbGl0eScpXWAsIGZhbHNlKTtcclxuICAgIGF3YWl0IGRyaXZlci5nZXRUZXh0KGVsLkVMRU1FTlQpLnNob3VsZC5ldmVudHVhbGx5LmVxdWFsKCdBY2Nlc3NpYmlsaXR5Jyk7XHJcbiAgfSk7XHJcbiAgaXQoJ3Nob3VsZCBmaW5kIHRoZSBsYXN0IGVsZW1lbnQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsT3JFbHMoJ3hwYXRoJywgYCgvLyR7YXR2fSlbbGFzdCgpXWAsIGZhbHNlKTtcclxuICAgIGxldCB0ZXh0ID0gYXdhaXQgZHJpdmVyLmdldFRleHQoZWwuRUxFTUVOVCk7XHJcbiAgICBbXCJPU1wiLCBcIlRleHRcIiwgXCJWaWV3c1wiLCBcIlByZWZlcmVuY2VcIl0uc2hvdWxkLmluY2x1ZGUodGV4dCk7XHJcbiAgfSk7XHJcbiAgaXQoJ3Nob3VsZCBmaW5kIGVsZW1lbnQgYnkgaW5kZXggYW5kIGVtYmVkZGVkIGRlc2MnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsT3JFbHMoJ3hwYXRoJywgYC8vJHtmfS8vJHthdHZ9WzVdYCwgZmFsc2UpO1xyXG4gICAgYXdhaXQgZHJpdmVyLmdldFRleHQoZWwuRUxFTUVOVCkuc2hvdWxkLmV2ZW50dWFsbHkuZXF1YWwoJ0NvbnRlbnQnKTtcclxuICB9KTtcclxuICBpdCgnc2hvdWxkIGZpbmQgYWxsIGVsZW1lbnRzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbE9yRWxzKCd4cGF0aCcsIGAvLypgLCB0cnVlKTtcclxuICAgIGVsLmxlbmd0aC5zaG91bGQuYmUuYWJvdmUoMik7XHJcbiAgfSk7XHJcbiAgaXQoJ3Nob3VsZCBmaW5kIHRoZSBmaXJzdCBlbGVtZW50IHdoZW4gc2VhcmNoaW5nIGZvciBhbGwgZWxlbWVudHMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsT3JFbHMoJ3hwYXRoJywgYC8vKmAsIHRydWUpO1xyXG4gICAgZWxbMF0uc2hvdWxkLmV4aXN0O1xyXG4gIH0pO1xyXG4gIGl0KCdzaG91bGQgZmluZCBsZXNzIGVsZW1lbnRzIHdpdGggY29tcHJlc3Npb24gdHVybmVkIG9uJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgYXdhaXQgZHJpdmVyLnVwZGF0ZVNldHRpbmdzKHtcImlnbm9yZVVuaW1wb3J0YW50Vmlld3NcIjogZmFsc2V9KTtcclxuICAgIGxldCBlbGVtZW50c1dpdGhvdXRDb21wcmVzc2lvbiA9IGF3YWl0IGRyaXZlci5maW5kRWxPckVscygneHBhdGgnLCBgLy8qYCwgdHJ1ZSk7XHJcbiAgICBhd2FpdCBkcml2ZXIudXBkYXRlU2V0dGluZ3Moe1wiaWdub3JlVW5pbXBvcnRhbnRWaWV3c1wiOiB0cnVlfSk7XHJcbiAgICBsZXQgZWxlbWVudHNXaXRoQ29tcHJlc3Npb24gPSBhd2FpdCBkcml2ZXIuZmluZEVsT3JFbHMoJ3hwYXRoJywgYC8vKmAsIHRydWUpO1xyXG4gICAgZWxlbWVudHNXaXRob3V0Q29tcHJlc3Npb24ubGVuZ3RoLnNob3VsZC5iZS5ncmVhdGVyVGhhbihlbGVtZW50c1dpdGhDb21wcmVzc2lvbi5sZW5ndGgpO1xyXG4gIH0pO1xyXG4gIGl0KCdzaG91bGQgZmluZCB0b2FzdCBtZXNzYWdlIGVsZW1lbnQgYnkgdGV4dCcsIGFzeW5jICgpID0+IHtcclxuICAgIGF3YWl0IGRyaXZlci5zdGFydEFjdGl2aXR5KGBpby5hcHBpdW0uYW5kcm9pZC5hcGlzYCwgYC52aWV3LlBvcHVwTWVudTFgKTtcclxuICAgIGF3YWl0IGRyaXZlci5pbXBsaWNpdFdhaXQoMjAwMCk7XHJcbiAgICBsZXQgcG9wVXAgPSBhd2FpdCBkcml2ZXIuZmluZEVsT3JFbHMoJ2FjY2Vzc2liaWxpdHkgaWQnLCAnTWFrZSBhIFBvcHVwIScsIGZhbHNlKTtcclxuICAgIGxldCAgcG9wVXBFbCA9IHBvcFVwLkVMRU1FTlQ7XHJcblxyXG4gICAgYXdhaXQgZHJpdmVyLmNsaWNrKHBvcFVwRWwpO1xyXG4gICAgbGV0IHNlYXJjaCA9IGF3YWl0IGRyaXZlci5maW5kRWxPckVscygneHBhdGgnLCBgLi8vKltAdGV4dD0nU2VhcmNoJ11gLCBmYWxzZSk7XHJcbiAgICBhd2FpdCBkcml2ZXIuY2xpY2soc2VhcmNoLkVMRU1FTlQpO1xyXG4gICAgYXdhaXQgZHJpdmVyLmZpbmRFbE9yRWxzKCd4cGF0aCcsIGAvLypbQHRleHQ9J0NsaWNrZWQgcG9wdXAgbWVudSBpdGVtIFNlYXJjaCddYCwgZmFsc2UpXHJcbiAgICAgICAgLnNob3VsZC5ldmVudHVhbGx5LmV4aXN0O1xyXG5cclxuICAgIGF3YWl0IGRyaXZlci5jbGljayhwb3BVcEVsKTtcclxuICAgIGxldCBhZGQgPWF3YWl0IGRyaXZlci5maW5kRWxPckVscygneHBhdGgnLCBgLi8vKltAdGV4dD0nQWRkJ11gLCBmYWxzZSk7XHJcbiAgICBhd2FpdCBkcml2ZXIuY2xpY2soYWRkLkVMRU1FTlQpO1xyXG4gICAgYXdhaXQgZHJpdmVyLmZpbmRFbE9yRWxzKCd4cGF0aCcsIGAvLypbQHRleHQ9J0NsaWNrZWQgcG9wdXAgbWVudSBpdGVtIEFkZCddYCwgZmFsc2UpXHJcbiAgICAgICAgLnNob3VsZC5ldmVudHVhbGx5LmV4aXN0O1xyXG5cclxuICAgIGF3YWl0IGRyaXZlci5jbGljayhwb3BVcEVsKTtcclxuICAgIGxldCBlZGl0ID0gYXdhaXQgZHJpdmVyLmZpbmRFbE9yRWxzKCd4cGF0aCcsIGAuLy8qW0B0ZXh0PSdFZGl0J11gLCBmYWxzZSk7XHJcbiAgICBhd2FpdCBkcml2ZXIuY2xpY2soZWRpdC5FTEVNRU5UKTtcclxuICAgIGF3YWl0IGRyaXZlci5maW5kRWxPckVscygneHBhdGgnLCBgLy8qW0B0ZXh0PSdDbGlja2VkIHBvcHVwIG1lbnUgaXRlbSBFZGl0J11gLCBmYWxzZSlcclxuICAgICAgICAuc2hvdWxkLmV2ZW50dWFsbHkuZXhpc3Q7XHJcblxyXG4gICAgbGV0IHNoYXJlID0gYXdhaXQgZHJpdmVyLmZpbmRFbE9yRWxzKCd4cGF0aCcsIGAuLy8qW0B0ZXh0PSdTaGFyZSddYCwgZmFsc2UpO1xyXG4gICAgYXdhaXQgZHJpdmVyLmNsaWNrKHNoYXJlLkVMRU1FTlQpO1xyXG4gICAgYXdhaXQgZHJpdmVyLmZpbmRFbE9yRWxzKCd4cGF0aCcsIGAvLypbQHRleHQ9J0NsaWNrZWQgcG9wdXAgbWVudSBpdGVtIFNoYXJlJ11gLCBmYWxzZSlcclxuICAgICAgICAuc2hvdWxkLmV2ZW50dWFsbHkuZXhpc3Q7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXX0=